<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <script>
    // 是否是原始数据类型
    // null/undefined/boolean/number/string/symbol/bigint
    function isPrimitive(value) {
      return value == null || ['boolean', 'number', 'string', 'bigint', 'symbol'].indexOf(typeof value) >= 0
    }

    // 是否为函数
    function isFunc(value) {
      return typeof value === 'function'
    }

    function cloneDeep(value) {
      const doClone = (value, deep = true) => {
        if (isPrimitive(value) || isFunc(value)) return value

        let newValue
        if (Array.isArray(value)) {
          newValue = []
          for (let i = 0, len = value.length; i < len; i++) {
            newValue[i] = doClone(value[i], deep)
          }
          return newValue
        }

        if (typeof value === 'object') {
          newValue = {}
          const keys = Object.keys(value)
          for (let i = 0, len = keys.length; i < len; i ++) {
            const key = keys[i]
            const val = value[key]
            newValue[key] = deep ? doClone(val, deep) : val
          }
          return newValue
        }

        return value
      }

      return doClone(value)
    }

    const o = {
      name: 'xpzheng',
      age: 20,
      address: {
        province: 'Guangdong',
        city: 'Shenzhen',
        location: {
          lat: 122,
          lng: 28
        }
      },
      say() {
        console.log('say hello')
      },
      arr: [
        { time: +new Date(), x: { fake: true } },
        2,
        3,
        4,
        function() {
          console.log('done')
        }
      ]
    }

    const o2 = cloneDeep(o)
    console.log(o2)
    console.log(o === o2)
  </script>
</body>
</html>
